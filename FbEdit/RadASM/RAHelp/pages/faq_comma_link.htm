<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FAQ Commas in link command</TITLE>
</HEAD>

<BODY>

<P style="background-color: #C0C0C0; border-style: solid; border-width: 1">

<B><font color="#0000FF" size="5">Commas in link command</font></B></P>

<P><B><I><font color="#800080">Originally posted by minor28</font></I></B><BR>
When I am linking a hook procedure in a dll with un-initialized data section to be shared there is a error message.<BR>
<BR>
My link switches are:<BR>
<BR>
7,O,$B\LINK.EXE /SECTION:.bss,S /DLL /DEF:$6 /SUBSYSTEM:WINDOWS /LIBPATH:"$L",3<BR>
<BR>
and the error message is:<BR>
<BR>
LINK : fatal error LNK1181: cannot open input file "S /DLL /DEF:$6 /SUBSYSTEM:WINDOWS /LIBPATH:C:\masm32\Lib.obj"<BR>
<BR>
Make error(s) occurred.<BR>
<BR>
I can't figure out what's wrong
</P>

<P><B><I><font color="#800080">Answer from KetiO</font></I></B><BR>
The ',' confuses RadASM.<BR>
Replace it with '|' like this:<BR>
<BR>
7,O,$B\LINK.EXE /SECTION:.bss|S /DLL /DEF:$6 /SUBSYSTEM:WINDOWS /LIBPATH:"$L",3<BR>
<BR>
The '|' will be replaced with a ',' by RadASM in the final parsing.</P>

</BODY>
</HTML>
