.const

btns					TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <24,IDM_FILE_PRINT,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <6,IDM_FILE_NEWFILE,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <7,IDM_FILE_OPENFILE,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <8,IDM_FILE_SAVEFILE,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <14,IDM_FILE_SAVEALLFILES,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <0,IDM_EDIT_CUT,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <1,IDM_EDIT_COPY,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <2,IDM_EDIT_PASTE,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <3,IDM_EDIT_UNDO,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <4,IDM_EDIT_REDO,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <5,IDM_EDIT_DELETE,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <12,IDM_EDIT_FIND,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <13,IDM_EDIT_REPLACE,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <20,IDM_EDIT_TOGGLEBM,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <21,IDM_EDIT_NEXTBM,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <22,IDM_EDIT_PREVIOUSBM,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <23,IDM_EDIT_CLEARBM,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <26,IDM_FORMAT_INDENT,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <25,IDM_FORMAT_OUTDENT,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <27,IDM_FORMAT_COMMENT,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <28,IDM_FORMAT_UNCOMMENT,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <9,IDM_VIEW_OUTPUTWINDOW,TBSTATE_ENABLED,TBSTYLE_BUTTON or TBSTYLE_CHECK,0,0>
						TBBUTTON <10,IDM_VIEW_PROJECTBROWSER,TBSTATE_ENABLED,TBSTYLE_BUTTON or TBSTYLE_CHECK,0,0>
						TBBUTTON <11,IDM_VIEW_TOOLBOX,TBSTATE_ENABLED,TBSTYLE_BUTTON or TBSTYLE_CHECK,0,0>
						TBBUTTON <19,IDM_VIEW_PROPERTIES,TBSTATE_ENABLED,TBSTYLE_BUTTON or TBSTYLE_CHECK,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <15,IDM_MAKE_ASSEMBLE,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <16,IDM_MAKE_BUILD,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <17,IDM_MAKE_RUN,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <18,IDM_MAKE_GO,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
						TBBUTTON <39,IDM_USERBTN1,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <40,IDM_USERBTN2,TBSTATE_ENABLED,TBSTYLE_BUTTON,0,0>
						TBBUTTON <0,0,TBSTATE_ENABLED,TBSTYLE_SEP,0,0>
nbtns					equ 43

.code

DoToolBar proc uses ebx esi

	;Create the imagelist
	invoke ImageList_Create,16,16,ILC_MASK or ILC_COLOR8,37,10
	mov		hTbrIml,eax
	invoke LoadBitmap,hInstance,IDB_MDITBR
	push	eax
	invoke ImageList_AddMasked,hTbrIml,eax,0FF00FFh
	pop		eax
	invoke DeleteObject,eax
	;Create the toolbar
	.if winTbr
		mov		eax,WS_CHILD or WS_VISIBLE or TBSTYLE_FLAT or TBSTYLE_TOOLTIPS or CCS_NODIVIDER or CCS_NORESIZE
	.else
		mov		eax,WS_CHILD or TBSTYLE_FLAT or TBSTYLE_TOOLTIPS or CCS_NODIVIDER or CCS_NORESIZE
	.endif
	invoke CreateWindowEx,0,addr szToolBar,0,eax,0,2,1024*3,22,hWnd,0,hInstance,0
	mov		hToolBar,eax
	.if fNT
		;Unicode
		invoke SendMessage,hToolBar,TB_SETUNICODEFORMAT,TRUE,0
	.endif
	;Set toolbar struct size
	invoke SendMessage,hToolBar,TB_BUTTONSTRUCTSIZE,sizeof TBBUTTON,0
	;Set toolbar buttons
	invoke SendMessage,hToolBar,TB_ADDBUTTONS,nbtns,addr btns
	;Set the imagelist
	invoke SendMessage,hToolBar,TB_SETIMAGELIST,0,hTbrIml
	ret

DoToolBar endp
